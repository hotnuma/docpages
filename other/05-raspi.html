<p><link href="../style.css" rel="stylesheet"></link></p>

<p><strong>[ <a href="../index.html">Home</a> | Raspi ]</strong></p>

<h2>Raspi</h2>

<hr>

<h4>References</h4>

<ul>
<li><p>Rpi</p>

<p><a href="https://github.com/orgs/raspberrypi-ui/repositories">https://github.com/orgs/raspberrypi-ui/repositories</a><br>
<a href="https://github.com/orgs/RPi-Distro/repositories">https://github.com/orgs/RPi-Distro/repositories</a><br>
<a href="https://github.com/orgs/raspberrypi/repositories">https://github.com/orgs/raspberrypi/repositories</a><br>
<a href="https://github.com/raspberrypi/bookworm-feedback/issues">https://github.com/raspberrypi/bookworm-feedback/issues</a>  </p></li>
<li><p>Labwc</p>

<p><a href="https://labwc.github.io/getting-started.html">https://labwc.github.io/getting-started.html</a><br>
<a href="https://github.com/labwc/labwc-artwork/">https://github.com/labwc/labwc-artwork/</a><br>
<a href="https://wiki.archlinux.org/title/Labwc">https://wiki.archlinux.org/title/Labwc</a>  </p></li>
</ul>

<h4>RaspiOS Lite 64</h4>

<ul>
<li><p>Installation</p>

<p><a href="https://www.raspberrypi.com/software/operating-systems/#raspberry-pi-os-64-bit">raspberry-pi-os-64-bit</a>  </p>

<p>Download RaspiOS Lite 64 bits and copy the image :</p>

<p><em>replace sdX with the corresponding device, for example sdc</em></p>

<pre><code>unxz ./raspios64-lite.img.xz
lsblk
umount /dev/sdX?
sudo dd if=./raspios64-lite.img of=/dev/sdX bs=4M conv=fsync status=progress
</code></pre></li>
<li><p>Upgrade</p>

<pre><code>sudo raspi-config
(change locale and timezone)
sudo apt update &amp;&amp; sudo apt upgrade
reboot
</code></pre></li>
<li><p>Switch to Trixie</p>

<p><code>sudo nano /etc/apt/sources.list.d/raspi.list</code></p>

<p>comment the repository like so :</p>

<pre><code>#deb http://archive.raspberrypi.com/debian/ bookworm main
# Uncomment line below then &#39;apt-get update&#39; to enable &#39;apt-get source&#39;
#deb-src http://archive.raspberrypi.com/debian/ bookworm main
</code></pre>

<p>edit sources.list : </p>

<p><code>sed -i.bak s/bookworm/trixie/g /etc/apt/sources.list</code></p>

<pre><code>sudo apt update &amp;&amp; sudo apt upgrade
sudo apt full-upgrade
reboot
</code></pre>

<p>list local raspi packages : <code>apt list ?obsolete</code></p></li>
<li><p>Install XFCE</p>

<pre><code>sudo tasksel
(select debian desktop and xfce)

sudo systemctl set-default graphical.target
sudo apt purge plymouth
reboot
</code></pre></li>
<li><p>Upgrade error</p>

<p><a href="https://serverfault.com/questions/905921/">https://serverfault.com/questions/905921/</a>  </p>

<pre><code>update-initramfs: Generating /boot/initrd.img-6.6.74+rpt-rpi-v8
mkinitramfs: failed to determine device for /
mkinitramfs: workaround is MODULES=most, check:
grep -r MODULES /etc/initramfs-tools
</code></pre>

<p>check MODULES : <code>grep -r MODULES= /etc/initramfs-tools</code></p>

<p><code>sudo nano /etc/initramfs-tools/initramfs.conf</code></p>

<p>change <strong>MODULES=dep</strong> to <strong>MODULES=most</strong></p>

<p><code>update-initramfs -u</code></p></li>
</ul>

<h4>Debian Trixie</h4>

<ul>
<li><p>Installation</p>

<p>Download an image from daily builds :<br>
<a href="https://raspi.debian.net/daily-images/">https://raspi.debian.net/daily-images/</a>  </p>

<p><em>the FAQ says these images are not compatible with the RPI 5</em></p>

<p>Default user is <strong>root</strong> with empty password.</p>

<pre><code>apt update &amp;&amp; apt upgrade
apt install sudo debconf kbd locales

dpkg-reconfigure tzdata
dpkg-reconfigure locales

useradd -s /bin/bash -d /home/&lt;username&gt; -m &lt;username&gt;
passwd &lt;username&gt;
usermod -aG sudo &lt;username&gt;
reboot
</code></pre>

<p>log as new user</p>

<pre><code>sudo tasksel
(select debian desktop and xfce)

sudo apt purge plymouth
sudo reboot
</code></pre>

<p>Add hostname manually in <code>/etc/hosts</code> :</p>

<pre><code>127.0.0.1   localhost
127.0.1.1   &lt;hostname&gt;
::1 localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
</code></pre></li>
</ul>

<h4>Manual configuration</h4>

<ul>
<li><p>Xfce Configuration</p>

<p><a href="https://wiki.archlinux.org/title/Xfwm">https://wiki.archlinux.org/title/Xfwm</a>  </p>

<p><code>xfconf-query -c xfwm4 -p /general/vblank_mode -s glx</code></p>

<p><code>xfconf-query -c xfce4-panel -p /force-all-internal -t bool -s true --create</code></p></li>
<li><p>Install labwc</p>

<p><code>sudo apt install labwc swaybg kanshi</code></p>

<p><a href="https://labwc.github.io/getting-started.html">https://labwc.github.io/getting-started.html</a>  </p>

<p>create configuration files for labwc in <code>~/.config/labwc</code>  </p>

<p>configs and themes : </p>

<p><a href="https://github.com/hotnuma/sysconfig/tree/master/labwc">https://github.com/hotnuma/sysconfig/tree/master/labwc</a>  </p>

<p>reboot and select the labwc session  </p></li>
<li><p>Menu icons</p>

<p>create settings.ini into <code>~/.config/gtk-3.0</code> :</p>

<pre><code>[Settings]
gtk-button-images=1
gtk-menu-images=1
</code></pre></li>
<li><p>Configure a static ip</p>

<p><a href="https://hotnuma.github.io/docpages/linux/10-network.html">https://hotnuma.github.io/docpages/linux/10-network.html</a>  </p></li>
</ul>

<h4>System Startup</h4>

<ul>
<li><p>Lightdm config</p>

<p><a href="https://wiki.archlinux.org/title/LightDM">https://wiki.archlinux.org/title/LightDM</a>  </p>

<pre><code>cat /etc/lightdm/lightdm.conf

[Seat:*]
autologin-guest=false
autologin-user=hotnuma
autologin-user-timeout=0
autologin-session=labwc
</code></pre>

<p>show current config : <code>lightdm --show-config</code></p></li>
<li><p>Wayland sessions</p>

<pre><code>ls /usr/share/wayland-sessions/

labwc.desktop
</code></pre></li>
<li><p>Processes</p>

<pre><code>total : 233156 kB / 35 prc
</code></pre></li>
</ul>

<h4>Other</h4>

<ul>
<li><p>apt-file</p>

<pre><code>sudo apt install apt-file
sudo apt-file update
</code></pre></li>
<li><p>Other programs</p>

<p><code>sudo apt install hardinfo inxi</code></p></li>
<li><p>Read CPU temperature</p>

<p><code>vcgencmd measure_temp</code></p></li>
<li><p>kernel, firmware, bootloader, eeprom</p>

<pre><code>uname -a
vcgencmd version
vcgencmd bootloader_version
vcgencmd bootloader_config
rpi-eeprom-config
</code></pre></li>
<li><p>USB Chipset</p>

<p><a href="https://forums.raspberrypi.com/viewtopic.php?t=245931">https://forums.raspberrypi.com/viewtopic.php?t=245931</a><br>
<a href="https://forums.raspberrypi.com/viewtopic.php?t=326157">https://forums.raspberrypi.com/viewtopic.php?t=326157</a>  </p>

<pre><code>That&#39;s true for most of the JMS578 family of USB 3.0 bridge chips,
but not necessarily with the 580 series USB 3.1 chips.
I have a USB 3.1 Gen 2 enclosure with a JMS583 chip that works
fine with Pi computers. It supports UASP in RPiOS, and TRIM works
with a udev rule.
</code></pre></li>
<li><p>Board model</p>

<p><code>cat /sys/firmware/devicetree/base/model</code></p></li>
<li><p>Release notes : </p>

<p><a href="https://downloads.raspberrypi.org/raspios_arm64/release_notes.txt">https://downloads.raspberrypi.org/raspios_arm64/release_notes.txt</a>  </p></li>
</ul>

<p><br/></p>

<!--

#### Old raspi docs

* rpi links

    https://www.raspberrypi.com/documentation/  
    https://www.raspberrypi.com/documentation/computers/raspberry-pi.html  
    https://linuxhint.com/gpio-pinout-raspberry-pi/  
    [tearing_test](https://www.youtube.com/watch?v=cuXsupMuik4)  
    [howto_desktops](https://forums.raspberrypi.com/viewtopic.php?t=133691)  
    [howto_autostart](https://forums.raspberrypi.com/viewtopic.php?t=294014)  
    https://github.com/raspberrypi/rpi-eeprom  

* Install Thorium Browser

    https://github.com/Alex313031/Thorium-Raspi/releases  
    
    `sudo unzip -d /opt/thorium thorium-browser_128.0.6613.194_arm64.zip`
    
    under wayland : `/opt/thorium/thorium --ozone-platform=wayland`

* Avoid keyring password
    
    https://unix.stackexchange.com/questions/324843/  
    
    `rm ~/.local/share/keyrings/*.keyring`
    
    Restart Chrome, when prompted to create a keyring, continue without entering a password. (Turns out you would have been okay if you did this the first time.)

* SD cards

    [best-ssd-storage](https://jamesachambers.com/best-ssd-storage-adapters-for-raspberry-pi-4-400/)  

* Revert to specific firmware using git commit hash

    https://www.raspberrypi.com/documentation/computers/os.html  
    
    `sudo rpi-update 6e61ab523f0a9d2fbb4319f6f6430d4c13203c0e`

* Revert to stable firmware

    ```
    sudo apt update
    sudo apt install --reinstall libraspberrypi0 libraspberrypi-{bin,dev,doc} raspberrypi-bootloader raspberrypi-kernel
    ```

* Fix screen tearing
    
    `/etc/xdg/menus/lxde-pi-applications.menu`
    
    https://forum.manjaro.org/t/how-to-fix-intel-screen-tearing-on-xfce/31361/1  
    
    ```
    1- Go to “setting manager”
    2- Go to “setting editor”
    3- Choose “xfwm4”
    4- Find “vblank_mode” and select
    5- Press the “edit”
    6- Type glx to “value” section
    7- Save and reboot

    Note: This is the gui way of those commands
    xfwm4 --replace --vblank=glx &
    xfconf-query -c xfwm4 -p /general/vblank_mode -s glx
    ```

* SSD Boot
    
    Change boot order with `raspi-config`
    
    View current EEPROM configuration : `rpi-eeprom-config`
    
    Edit configuration : `sudo -E rpi-eeprom-config --edit`
    
    Add `USB_MSD_DISCOVER_TIMEOUT=5`
    
    [udev_trim](https://forums.raspberrypi.com/viewtopic.php?t=307276#p1839171)  

* CPU governor

    https://askubuntu.com/questions/1021748/  
    https://raspberrypi.stackexchange.com/questions/9034/  

* Display settings

    https://forums.raspberrypi.com/viewtopic.php?p=1945199#p1945199  
    https://forums.raspberrypi.com/viewtopic.php?p=1945198#p1945198  
    https://forums.raspberrypi.com/viewtopic.php?t=325011#p1945199  
    
    `video=HDMI-1:800x480@60`

* Test RPi version

    https://forums.raspberrypi.com/viewtopic.php?t=34678  
    https://forums.raspberrypi.com/viewtopic.php?t=200059  

    ```
    ARCH=$(uname -m)
    VERSION=$(cat /etc/debian_version)
    if [[ $ARCH != "aarch64" ]] || [[ $VERSION != 11* ]]; then
        echo " *** This script was tested only on a Raspberry Pi 4B 64 bit"
        echo " *** abort..."
        exit 1
    fi

    cat /proc/cpuinfo
    grep -q BCM2708 /proc/cpuinfo
    cat /etc/*-release
    cat /proc/device-tree/model
    cat /sys/firmware/devicetree/base/model
    ```

* Anti-rpi

    https://www.fsf.org/resources/hw/single-board-computers  
    https://wiki.debian.org/RaspberryPi/  

    Limitations
    
    - 1.2A current limit for all USB plugs
    - slow SD controller (40 MB/s)
    - incompatible usb to sata controllers

* Drive consumption

    Toshiba Canvio Basics : a maximum of 900mA power, even in the largest capacity version.
    
    Kingston a400 SSD : 0.195W Idle / 0.279W Avg / 0.642W (MAX) Read / 1.535W (MAX) Write

* Upgrade
    
    https://gist.github.com/jauderho/6b7d42030e264a135450ecc0ba521bd8  
    https://raspberrytips.com/update-raspberry-pi-latest-version/  

-->
